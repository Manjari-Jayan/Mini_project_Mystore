{% include 'navigation.html' %}
{% load static %}
<link href="{% static 'css/simple-sidebar.css' %}" rel="stylesheet">
<div class="d-flex" id="wrapper">
  <div class="bg-light border-right" id="sidebar-wrapper">
    <div class="sidebar-heading">
 Filter by category</div>
      <div class="list-group list-group-flush">
        <a href="{% url 'user_product' 0 %}" class="list-group-item list-group-item-action bg-light">
All Product</a>
        {% for i in allcategory %}
          <a href="{% url 'user_product' i.id %}" class="list-group-item list-group-item-action bg-light">
            {{i.name}}</a>
        {% endfor %}
      </div>
    </div>
 
    <div id="page-content-wrapper">
      <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <button class="btn btn-primary" id="menu-toggle">
<i class="fa fa-bars">
</i>

</button>
        <h4 style="color:red;margin-left:30%">
View {{category.name}} Product</h4>
      </nav>
      <div class="container-fluid mt-2">
          <div class="container-fluid">
              <div class="row w-100 mx-auto">
                {% for j in product %}                   
                <div class="col-md-3">
                    <div class="card" align="center" style="border:1px solid lightgrey">
                        <img class="card-img-top img-thumbnail" src="{{j.image.url}}" style="width:100%" alt="card-img">
                        <div class="card-body">
                          <h6 class="card-title">
                    {{j.name}} Rs.{{j.price}}</h6>
                          <p class="card-text" style="font-size:14px">
                    {{j.description}}</p>
                    <div class="d-flex justify-content-center">
                      <a href="/add-to-cart/{{j.id}}/" class="text-white">
                          <button type="submit" class="btn btn-primary mr-2">
                              <i class="fa fa-shopping-cart"></i>
                          </button>
                      </a>
                      <a href="/product-detail/{{j.id}}/" class="text-white">
                          <button type="submit" class="btn btn-danger mr-2">
                              <i class="fa fa-eye"></i>
                          </button>
                      </a>
                      <a href="/product_comparison/{{j.id}}/" class="text-white">
                          <button type="submit" class="btn btn-primary mr-2">
                              <i class="fa fa-exchange-alt"></i>
                          </button>
                      </a>
                      <form action="/wishlist/{{j.id}}/" method="post" class="like-form">
                          {% csrf_token %}
                          <button type="submit" class="btn btn-success like-button {% if j.is_liked_by_user %}liked{% endif %}">
                              <i class="fa fa-heart"></i>
                          </button>
                      </form>
                    </div>
                              
                        </div>
                      </div>
                  </div>
                {% empty %}
                  <div class="col-md-12">
                    <div class="card">
                        <div class="card-body">
                          <img src="{% static 'images/empty.jpg' %}" />
                        </div>
                      </div>
                  </div>
                {% endfor %}
              </div>
          </div>
      </div>
    </div>
  </div>
</div>
 
<script>
  $("#menu-toggle").click(function(e) {
    e.preventDefault();
    $("#wrapper").toggleClass("toggled");
  });
</script>
<script>
  $(document).ready(function () {
      $('.like-form').on('submit', function (e) {
          e.preventDefault();
          var form = $(this);
          var likeButton = form.find('.like-button');
          var heartIcon = likeButton.find('.fa-heart');
          var productId = likeButton.data('product-id');
          var productName = likeButton.data('product-name');
          var message = '';

          $.ajax({
              url: form.attr('action'),
              type: form.attr('method'),
              data: form.serialize(),
              success: function () {
                  if (heartIcon.hasClass('liked')) {
                      heartIcon.removeClass('liked');
                      likeButton.removeClass('btn-danger'); // Remove the red color class
                      likeButton.addClass('btn-success'); // Add the green color class
                      message = productName + ' removed from your wishlist.';
                  } else {
                      heartIcon.addClass('liked');
                      likeButton.removeClass('btn-success'); // Remove the green color class
                      likeButton.addClass('btn-danger'); // Add the red color class
                      message = productName + ' added to your wishlist.';
                  }

                  // Display the pop-up message
                  $('#popup-message strong').text(message);
                  $('#popup-message').fadeIn().delay(2000).fadeOut();
              }
          });
      });
  });
</script>
