{% load static %}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">


<!-- Bootstrap CSS -->
{% comment %} <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"> {% endcomment %}
<!-- Font Awesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css"
      integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
      crossorigin="anonymous">
<!-- Google Font -->
<link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>

<!-- Custom CSS -->
<link rel="stylesheet" href="{% static 'css/mystyle.css' %}">
<link rel="icon" href="{% static 'images/donation.png' %}">
<title>TechTrove</title>
<!-- Start Nagigation -->


<style>
.customSubmenu{

    position:absolute;
    top: 30px;
    left: 180px;

}
.dropdown-submenu {
    position: relative;
  }
  
  .dropdown-submenu > .dropdown-menu {
    left: 100%;
    /* -6px gives dropdown-menu's padding+border */
    top: -6px;
  }
  
  .dropdown-submenu:hover > .dropdown-menu, .dropdown-submenu > a:focus + .dropdown-menu {
    /* :focus support is incomplete - pressing Tab sets focus to submenu, but that immediately hides submenu */
    display: block;
  }
  
#search-suggestions {
    color: white;
}
  
</style>
<nav class="navbar navbar-expand-sm bg-dark navbar-white height:30px">
    
    <div class="container-fluid">
        <a href="#" class="navbar-brand">
            &nbsp;<span style="color:white">Tech</span>
            {% comment %} <span style="color:green"></span> {% endcomment %}
            <span style="color:white">Trove</span></a>
        <!--<span class="navbar-text blinking">Enjoy Programming</span>-->
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#myMenu">
            <span class="navbar-toggler-icon"></span>
        </button>

        {% comment %} <div class="collapse navbar-collapse text-center" id="myMenu">
         <li class="nav-item"> 
            <form class="form-inline my-2 my-lg-0" action=" {% url "search_products" %}" method="GET">
                <input class="form-control mr-sm-2" type="search" name="q" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </li> 
    </div> {% endcomment %}

    <div class="collapse navbar-collapse text-center" id="myMenu">
        <form class="form-inline my-2 my-lg-0" action="{% url "search_products" %}" method="GET">
            <input class="form-control mr-sm-2" type="search" name="q" id="search-input" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
        <div id="search-suggestions"></div> <!-- This is the container for search suggestions -->
    </div>
        
        <div class="collapse navbar-collapse text-center" id="myMenu">
            <ul class="navbar-nav pl-5 custom-nav ml-auto">
                <li class="nav-item "><a href="/main/" class="nav-link "><span style="color: white;"><i class="fas fa-home"></i></span>
                <span style="color: white;">Home{{is_authenticated}}</span> </a></li>
                
                
               
                
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link " id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: white;">
                        <span style="color: white;"> Product</span>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        {% for c in nested_categories %}
                        <li class="dropdown-submenu">
                            <a class="dropdown-item dropdown-toggle" href="/user-product/{{ c.category.id }}">{{ c.category.name }}</a>
                            <ul class="dropdown-menu customSubmenu tog">
                                {% for subcategory in c.subcategories %}
                                <li class="dropdown-submenu"><a class="dropdown-item dropdown-toggle hello" href="/brand/{{subcategory.id}}">{{subcategory.name }}</a>
                                    <ul class="dropdown-menu customSubmenu tog">
                                        {% comment %} {% for series in category_dict.subcategories %}
                                        <li class="dropdown-submenu"><a class="dropdown-item dropdown-toggle " href="/brand/{{subcategory.id}}">{{subcategory.name }}</a>
                                        
                                        </li>
                                        {% endfor %} {% endcomment %}
                                    </ul>
                                
                                
                                </li>
                                {% endfor %}
                            </ul>
                            
                        </li>
                        {% endfor %}
                    </ul>
                </li> 


               




        
                


               
                
                
                
                {% comment %} <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: white;">
                      Product
                    </a>
                    
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        {% for category_dict in nested_categories %}
                        <li class="dropdown-submenu">
                            <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">{{ category_dict.category.name }}</a>
                            <ul class="dropdown-menu">
                                {% for subcategory in category_dict.subcategories %}
                                <li><a class="dropdown-item" href="#">{{ subcategory.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </li>
                        {% endfor %}
                    </ul>
                    
                  </li>
                </li> {% endcomment %}




                {% comment %} <li class="nav-item"><a href="/user-product/0" class="nav-link"><span style="color: white;">Product</span></a>
                
                </li> {% endcomment %}

                {% if not request.user.is_authenticated %}
                <li class="nav-item"><a href="/about/" class="nav-link"><span style="color: white;">About Us</span></a></li>
                <li class="nav-item"><a href="/contact/" class="nav-link"><span style="color: white;">Contact Us</span></a></li>
                <li class="nav-item"><a href="{% url 'userlogin' %}" class="nav-link"><span style="color: white;">Login</span></a></li>
                <li class="nav-item"><a href="{% url 'registration' %}" class="nav-link"><span style="color: white;">Signup</span></a></li>
                {% comment %} <li class="nav-item"><a href="{% url 'admin_login' %}" class="nav-link">Admin Login</a></li> {% endcomment %}
                {% else %}
                {% comment %} <li class="nav-item"><a href="" class="nav-link">Feedback</a></li> {% endcomment %}
                <li class="nav-item"><a href="/view_wishlist/" class="nav-link"><span style="color: white;">My Wishlist</span></a></li>
                <li class="nav-item"><a href="/cart/" class="nav-link"><span style="color: white;">My Cart</span></a></li>
               
                <li class="nav-item dropdown">
                    <a class="nav-link " href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        <img src="{% static 'images/useravatar.png' %}"
                             style="width:40px;height:40px;border-radius:50%"/>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" style="width: 200px" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="/profile/">Profile</a>
                        <a class="dropdown-item" href="/change_password/">Change Password</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/logout/">Logout</a>
                    </div>
                </li>

                {% endif %}
            </ul>
        </div>
    </div>
</nav> <!-- End Navigation -->
{% block body %}{% endblock %}
{% for i in messages %}
<script>
    alert('{{i}}');
</script>


{% endfor %}

<script>
    {% comment %} document.addEventListener('DOMContentLoaded', function () {
        var dropdownToggles = document.querySelectorAll('.dropdown-toggle');
        for (var i = 0; i < dropdownToggles.length; i++) {
            dropdownToggles[i].addEventListener('mouseover', function (e) {
                e.preventDefault();
                var submenu = this.nextElementSibling;
                if (submenu.style.display === 'block') {
                    submenu.style.display = 'none';
                } else {
                    submenu.style.display = 'block';
                }
            });
           dropdownToggles[i].addEventListener('mouseleave', function (e) {
                e.preventDefault();
                var submenu = this.nextElementSibling;
                if (submenu.style.display === 'block' && !submenu.classList.contains('tog')) {
                    submenu.style.display = 'none';
                } else {
                    submenu.style.display = 'block';
                }
            }); 
        }
    }); {% endcomment %}

    {% comment %} document.addEventListener('DOMContentLoaded', function () {
        var dropdownToggles = document.querySelectorAll('.dropdown-toggle');
        
        dropdownToggles.forEach(function(dropdownToggle) {
            var submenu = dropdownToggle.nextElementSibling;
            
            dropdownToggle.addEventListener('mouseover', function (e) {
                e.preventDefault();
                submenu.style.display = 'block';
            });
            
            dropdownToggle.addEventListener('mouseleave', function (e) {
                e.preventDefault();
                submenu.style.display = 'none';
            });
            
            submenu.addEventListener('mouseenter', function (e) {
                e.preventDefault();
                submenu.style.display = 'block';
            });
            
            submenu.addEventListener('mouseleave', function (e) {
                e.preventDefault();
                submenu.style.display = 'none';
            });
        });
    });
     {% endcomment %}
</script>

<script type="text/javascript">
    $(document).ready(function() {
        $('#search-input').on('input', function() {
            var query = $(this).val();
            if (query.length >= 2) {
                $.ajax({
                    url: "{% url 'search_suggestions' %}",
                    method: "GET",
                    data: { q: query },
                    success: function(data) {
                        // Update the suggestions container with the received data
                        $('#search-suggestions').html(data);
                    }
                });
            } else {
                // Clear suggestions when the input is less than 2 characters
                $('#search-suggestions').html('');
            }
        });
    });
</script>